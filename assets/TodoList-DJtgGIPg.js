import{d as J,c as L,p as F,i as Q,w as X,h as Y,o as S,a as z,r as ee,b as o,e as j,t as U,f as y,g as b,u as h,R as O,F as M,j as w,k as te,l as ae,m as T,L as re,n as C,q as ne,v as se,s as R,x as le}from"./index-D7V8y_gX.js";function E(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function x(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?E(Object(n),!0).forEach(function(s){p(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):E(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function oe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t||"default");if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ie(e){var t=oe(e,"string");return typeof t=="symbol"?t:t+""}function A(e){"@babel/helpers - typeof";return A=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},A(e)}function p(e,t,n){return t=ie(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ue(e,t){if(e==null)return{};var n={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;n[s]=e[s]}return n}function ce(e,t){if(e==null)return{};var n=ue(e,t),s,i;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(i=0;i<c.length;i++)s=c[i],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}var fe=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},q={exports:{}};(function(e){(function(t){var n=function(a,r,u){if(!m(r)||g(r)||k(r)||I(r)||v(r))return r;var _,P=0,W=0;if(f(r))for(_=[],W=r.length;P<W;P++)_.push(n(a,r[P],u));else{_={};for(var D in r)Object.prototype.hasOwnProperty.call(r,D)&&(_[a(D,u)]=n(a,r[D],u))}return _},s=function(a,r){r=r||{};var u=r.separator||"_",_=r.split||/(?=[A-Z])/;return a.split(_).join(u)},i=function(a){return N(a)?a:(a=a.replace(/[\-_\s]+(.)?/g,function(r,u){return u?u.toUpperCase():""}),a.substr(0,1).toLowerCase()+a.substr(1))},c=function(a){var r=i(a);return r.substr(0,1).toUpperCase()+r.substr(1)},l=function(a,r){return s(a,r).toLowerCase()},d=Object.prototype.toString,v=function(a){return typeof a=="function"},m=function(a){return a===Object(a)},f=function(a){return d.call(a)=="[object Array]"},g=function(a){return d.call(a)=="[object Date]"},k=function(a){return d.call(a)=="[object RegExp]"},I=function(a){return d.call(a)=="[object Boolean]"},N=function(a){return a=a-0,a===a},B=function(a,r){var u=r&&"process"in r?r.process:r;return typeof u!="function"?a:function(_,P){return u(_,a,P)}},$={camelize:i,decamelize:l,pascalize:c,depascalize:l,camelizeKeys:function(a,r){return n(B(i,r),a)},decamelizeKeys:function(a,r){return n(B(l,r),a,r)},pascalizeKeys:function(a,r){return n(B(c,r),a)},depascalizeKeys:function(){return this.decamelizeKeys.apply(this,arguments)}};e.exports?e.exports=$:t.humps=$})(fe)})(q);var de=q.exports,ve=["class","style"];function pe(e){return e.split(";").map(function(t){return t.trim()}).filter(function(t){return t}).reduce(function(t,n){var s=n.indexOf(":"),i=de.camelize(n.slice(0,s)),c=n.slice(s+1).trim();return t[i]=c,t},{})}function me(e){return e.split(/\s+/).reduce(function(t,n){return t[n]=!0,t},{})}function G(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(typeof e=="string")return e;var s=(e.children||[]).map(function(v){return G(v)}),i=Object.keys(e.attributes||{}).reduce(function(v,m){var f=e.attributes[m];switch(m){case"class":v.class=me(f);break;case"style":v.style=pe(f);break;default:v.attrs[m]=f}return v},{attrs:{},class:{},style:{}});n.class;var c=n.style,l=c===void 0?{}:c,d=ce(n,ve);return Y(e.tag,x(x(x({},t),{},{class:i.class,style:x(x({},i.style),l)},i.attrs),d),s)}var Z=!1;try{Z=!0}catch{}function ye(){if(!Z&&console&&typeof console.error=="function"){var e;(e=console).error.apply(e,arguments)}}function K(e,t){return Array.isArray(t)&&t.length>0||!Array.isArray(t)&&t?p({},e,t):{}}function he(e){var t,n=(t={"fa-spin":e.spin,"fa-pulse":e.pulse,"fa-fw":e.fixedWidth,"fa-border":e.border,"fa-li":e.listItem,"fa-inverse":e.inverse,"fa-flip":e.flip===!0,"fa-flip-horizontal":e.flip==="horizontal"||e.flip==="both","fa-flip-vertical":e.flip==="vertical"||e.flip==="both"},p(p(p(p(p(p(p(p(p(p(t,"fa-".concat(e.size),e.size!==null),"fa-rotate-".concat(e.rotation),e.rotation!==null),"fa-pull-".concat(e.pull),e.pull!==null),"fa-swap-opacity",e.swapOpacity),"fa-bounce",e.bounce),"fa-shake",e.shake),"fa-beat",e.beat),"fa-fade",e.fade),"fa-beat-fade",e.beatFade),"fa-flash",e.flash),p(p(t,"fa-spin-pulse",e.spinPulse),"fa-spin-reverse",e.spinReverse));return Object.keys(n).map(function(s){return n[s]?s:null}).filter(function(s){return s})}function V(e){if(e&&A(e)==="object"&&e.prefix&&e.iconName&&e.icon)return e;if(F.icon)return F.icon(e);if(e===null)return null;if(A(e)==="object"&&e.prefix&&e.iconName)return e;if(Array.isArray(e)&&e.length===2)return{prefix:e[0],iconName:e[1]};if(typeof e=="string")return{prefix:"fas",iconName:e}}var H=J({name:"FontAwesomeIcon",props:{border:{type:Boolean,default:!1},fixedWidth:{type:Boolean,default:!1},flip:{type:[Boolean,String],default:!1,validator:function(t){return[!0,!1,"horizontal","vertical","both"].indexOf(t)>-1}},icon:{type:[Object,Array,String],required:!0},mask:{type:[Object,Array,String],default:null},maskId:{type:String,default:null},listItem:{type:Boolean,default:!1},pull:{type:String,default:null,validator:function(t){return["right","left"].indexOf(t)>-1}},pulse:{type:Boolean,default:!1},rotation:{type:[String,Number],default:null,validator:function(t){return[90,180,270].indexOf(Number.parseInt(t,10))>-1}},swapOpacity:{type:Boolean,default:!1},size:{type:String,default:null,validator:function(t){return["2xs","xs","sm","lg","xl","2xl","1x","2x","3x","4x","5x","6x","7x","8x","9x","10x"].indexOf(t)>-1}},spin:{type:Boolean,default:!1},transform:{type:[String,Object],default:null},symbol:{type:[Boolean,String],default:!1},title:{type:String,default:null},titleId:{type:String,default:null},inverse:{type:Boolean,default:!1},bounce:{type:Boolean,default:!1},shake:{type:Boolean,default:!1},beat:{type:Boolean,default:!1},fade:{type:Boolean,default:!1},beatFade:{type:Boolean,default:!1},flash:{type:Boolean,default:!1},spinPulse:{type:Boolean,default:!1},spinReverse:{type:Boolean,default:!1}},setup:function(t,n){var s=n.attrs,i=L(function(){return V(t.icon)}),c=L(function(){return K("classes",he(t))}),l=L(function(){return K("transform",typeof t.transform=="string"?F.transform(t.transform):t.transform)}),d=L(function(){return K("mask",V(t.mask))}),v=L(function(){return Q(i.value,x(x(x(x({},c.value),l.value),d.value),{},{symbol:t.symbol,title:t.title,titleId:t.titleId,maskId:t.maskId}))});X(v,function(f){if(!f)return ye("Could not find one or more icon(s)",i.value,d.value)},{immediate:!0});var m=L(function(){return v.value?G(v.value.abstract[0],{},s):null});return function(){return m.value}}});const ge={class:"todoList_label changeBackgroundColor"},_e=["value","checked","onChange"],be={__name:"TodoItem",props:["todo-list"],emits:["del-todo","toggle-status"],setup(e,{emit:t}){const n=e,s=t;return(i,c)=>(S(!0),z(M,null,ee(n.todoList,l=>(S(),z("li",{key:l.id},[o("label",ge,[o("input",{class:"todoList_input",type:"checkbox",value:l.status,checked:l.status,onChange:j(d=>s("toggle-status",l),["prevent"])},null,40,_e),o("span",null,U(l.content),1)]),y(h(O),{to:"#",onClick:j(d=>s("del-todo",l.id),["prevent"])},{default:b(()=>[y(h(H),{icon:"fa-solid fa-trash"})]),_:2},1032,["onClick"])]))),128))}},Oe={id:"todoListPage",class:"bg-half"},xe={class:"todo_sm"},ke={class:"conatiner todoListPage vhContainer"},we={class:"todoList_Content"},Te={class:"inputBox"},Le={key:0,class:"todoList_list"},Ce={class:"todoList_tab"},Se={class:"changeBackgroundColor"},Be={class:"changeBackgroundColor"},Pe={class:"changeBackgroundColor"},ze={class:"todoList_items"},$e={class:"todoList_item"},je={className:"todoList_statistics"},Ae=o("p",{style:{color:"red"}},"清除已完成項目",-1),Ie={key:1,className:"empty"},Ne=o("p",{align:"center"},"目前尚無待辦事項",-1),De=o("img",{src:"https://github.com/spikesandmaen484/vue-todolist-api/blob/main/src/img/person.png?raw=true",alt:"目前尚無待辦事項"},null,-1),Re=[Ne,De],Ke={__name:"TodolistPage",setup(e){const t="https://todolist-api.hexschool.io",n=w(""),s=w("全部"),i=w({uid:"",nickname:""}),c=te(),l=w(!1),d=a=>{switch(s.value=a,s.value){case"全部":m.value=f.value;break;case"待完成":m.value=f.value.filter(r=>!r.status);break;case"已完成":m.value=f.value.filter(r=>r.status);break}},v=async()=>{try{l.value=!0;const a=await T.post(`${t}/users/sign_out`,{},{headers:{Authorization:n.value}});setTimeout(()=>{alert("登出成功!"),n.value="",c.push("/"),l.value=!1},1e3)}catch(a){const r=a.message.split(" ");r[r.length-1]==400?alert("登出失敗!"):alert("登出發生錯誤:"+a.message),l.value=!1}},m=w([]),f=w([]),g=w(""),k=async()=>{try{const a=await T.get(`${t}/todos`,{headers:{Authorization:n.value}});m.value=a.data.data,f.value=a.data.data,s.value="全部"}catch(a){alert("取得TodoList失敗:"+a.message)}},I=async()=>{try{if(g.value.trimEnd()==""){alert("新增的待辦事項不能空白，請重新輸入"),g.value="";return}if(f.value.find(r=>r.content==g.value.trimEnd())){alert("新增的待辦事項已存在! 請重新輸入"),g.value="";return}l.value=!0,(await T.post(`${t}/todos`,{content:g.value},{headers:{Authorization:n.value}})).status==201&&(alert("新增Todo成功!"),g.value="",k(),l.value=!1)}catch(a){alert("新增Todo失敗:"+a.message),l.value=!1}},N=async a=>{try{l.value=!0,(await T.delete(`${t}/todos/${a}`,{headers:{Authorization:n.value}})).status==200&&(alert("刪除Todo完成!"),k(),l.value=!1)}catch(r){alert("刪除Todo失敗:"+r.message),l.value=!1}},B=async a=>{try{await T.patch(`${t}/todos/${a.id}/toggle`,{},{headers:{Authorization:n.value}}),k()}catch(r){alert("更改狀態失敗: "+r.message)}},$=async()=>{try{l.value=!0;const a=f.value.filter(r=>r.status&&T.delete(`${t}/todos/${r.id}`,{headers:{Authorization:n.value}}));if(a.length==0){alert("當前沒有已完成項目!"),l.value=!1;return}await Promise.all(a),setTimeout(()=>{alert("清除已完成事項成功!"),k(),l.value=!1},1e3)}catch(a){alert("清除已完成事項失敗: "+a.message),l.value=!1}};return ae(async()=>{n.value=document.cookie.replace(/(?:(?:^|.*;\s*)customTodoToken\s*=\s*([^;]*).*$)|^.*$/,"$1"),n.value||setTimeout(()=>{alert("無 token，頁面將轉至登入頁"),c.push("/")},500);try{l.value=!0;const a=await T.get(`${t}/users/checkout`,{headers:{Authorization:n.value}});i.value=a.data,k(),l.value=!1}catch(a){alert(a.message),setTimeout(()=>{alert("驗證失效"),c.push("/"),l.value=!1},1e3)}}),(a,r)=>(S(),z(M,null,[y(h(re),{active:l.value,"onUpdate:active":r[0]||(r[0]=u=>l.value=u)},null,8,["active"]),o("div",Oe,[o("nav",null,[o("h1",null,[y(h(O),{to:"#"},{default:b(()=>[C("ONLINE TODO LIST")]),_:1})]),o("ul",null,[o("li",xe,[y(h(O),{to:"/todolist",class:"formControls_btnLink"},{default:b(()=>[o("span",null,U(i.value.nickname)+"的代辦",1)]),_:1})]),C("   "),o("li",null,[y(h(O),{to:"",class:"formControls_btnLink",onClick:j(v,["prevent"])},{default:b(()=>[C("登出")]),_:1})])])]),o("div",ke,[o("div",we,[o("div",Te,[ne(o("input",{type:"text",placeholder:"請輸入待辦事項","onUpdate:modelValue":r[1]||(r[1]=u=>g.value=u)},null,512),[[se,g.value]]),y(h(O),{to:"#",class:"formControls_btnLink",onClick:I},{default:b(()=>[y(h(H),{icon:"fa-solid fa-plus"})]),_:1})]),f.value.length>0?(S(),z("div",Le,[o("ul",Ce,[o("li",Se,[y(h(O),{to:"#",class:R([s.value=="全部"?"active":""]),onClick:r[2]||(r[2]=u=>d("全部"))},{default:b(()=>[C("全部")]),_:1},8,["class"])]),o("li",Be,[y(h(O),{to:"#",class:R([s.value=="待完成"?"active":""]),onClick:r[3]||(r[3]=u=>d("待完成"))},{default:b(()=>[C("待完成")]),_:1},8,["class"])]),o("li",Pe,[y(h(O),{to:"#",class:R([s.value=="已完成"?"active":""]),onClick:r[4]||(r[4]=u=>d("已完成"))},{default:b(()=>[C("已完成")]),_:1},8,["class"])])]),o("div",ze,[o("ul",$e,[y(be,{"todo-list":m.value,onDelTodo:N,onToggleStatus:B},null,8,["todo-list"])]),o("div",je,[o("p",null,U(f.value.filter(u=>!u.status).length)+" 個待完成項目",1),y(h(O),{to:"#",className:"formControls_btnLink",onClick:j($,["prevent"])},{default:b(()=>[Ae]),_:1})])])])):(S(),z("div",Ie,Re))])])])],64))}},Ue={__name:"TodoList",setup(e){return(t,n)=>(S(),le(Ke))}};export{Ue as default};
